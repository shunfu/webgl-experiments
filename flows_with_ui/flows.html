<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Flows with Strange Attractors</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                background-color: #000000;
                margin: 0px;
                overflow: hidden;
                font-family:Monospace;
                font-size:13px;
                text-align:center;
                font-weight: bold;
                text-align:center;
            }

            a {
                color:#0078ff;
            }

            #info {
                color: #fff;
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
                z-index: 100;
            }

            .panel {
                position: fixed;
                padding: 30px;
                color: #fff;
                cursor: default;
                width: 400px;
                right: 30px;
            }
        </style>
    </head>
    <body>

        <div id="info">Flows with Strange Attractors</div>

        <link href="css/jquery-ui-1.10.3.custom.min.css" rel="stylesheet">
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/jquery-ui-1.10.3.custom.min.js"></script>

        <div id="panel" class="panel">
            <header><h2 class="header_title">Select Attractor</h2></header>
            <div id="accordion">
                <h3>Lorenz Strange Attractor</h3>
                <div>
                    Equations go here and add a button
                    <button id="lorenzButton">Show me!</button>
                </div>
                <h3>R&ouml;ssler Attractor</h3>
                <div>Phasellus mattis tincidunt nibh.</div>
                <h3>H&eacute;non Map</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Chua's Attractor (Double Scroll Attractor)</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Li&eacute;nard-Van der Pol Oscillator</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Rabinovich-Fabrikant System</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Tinkerbell Map</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Ikeda Map</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Rainey Dynamical System</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
                <h3>Fu Attractor</h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
            </div>
        </div>

        <script src="js/three.min.js"></script>
        <script src="js/Detector.js"></script>
        <script src="js/stats.min.js"></script>

        <script src="lorenz.js"></script>

        <script>
            $(function() {
                
                $("#accordion").accordion({
                    collapsible: true,
                    heightStyle: "content"
                });

                $("#panel").draggable();

                $("button").button();

                $("#lorenzButton").click(function() {
                    execute = false;
                    // console.log(geometry);
                    geometry.__webglVertexBuffer = null;
                    geometry.__webglColorBuffer = null;
                    renderer.clear();
                    removeAll();
                    execute = true;
                    lorenzInit();
                    lorenzAnimate();
                });

            });
        </script>

        <script>

            if (!Detector.webgl) Detector.addGetWebGLMessage();

            var container, stats;
            var camera, scene, renderer, particles, geometry, material, parameters, i, h, color;
            var coords = [];
            var trajColors = [];
            var colors = [];
            var particleNum = 0;
            var execute = true;

            var mouseX = 0, mouseY = 0;

            var windowHalfX = window.innerWidth / 2;
            var windowHalfY = window.innerHeight / 2;

            container = document.createElement('div');
            document.body.appendChild(container);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 3000);

            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.0007);

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);

            stats = new Stats();
            stats.domElement.style.position = 'absolute';
            stats.domElement.style.top = '0px';
            container.appendChild(stats.domElement);

            document.addEventListener('mousemove', onDocumentMouseMove, false);
            document.addEventListener('touchstart', onDocumentTouchStart, false);
            document.addEventListener('touchmove', onDocumentTouchMove, false);

            window.addEventListener('resize', onWindowResize, false);

            lorenzInit();
            lorenzAnimate();

            function removeAll() {
                for (i = scene.children.length - 1; i >= 0; i --) {
                    var object = scene.children[i];

                    if (object instanceof THREE.ParticleSystem) {
                        scene.remove(object);
                    }
                }
            }

            function onWindowResize() {
                windowHalfX = window.innerWidth / 2;
                windowHalfY = window.innerHeight / 2;

                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize(window.innerWidth, window.innerHeight);
            }

            function onDocumentMouseMove(event) {
                mouseX = event.clientX - windowHalfX;
                mouseY = event.clientY - windowHalfY;
            }

            function onDocumentTouchStart(event) {
                if (event.touches.length === 1) {
                    event.preventDefault();
                    mouseX = event.touches[0].pageX - windowHalfX;
                    mouseY = event.touches[0].pageY - windowHalfY;
                }
            }

            function onDocumentTouchMove(event) {
                if (event.touches.length === 1) {
                    event.preventDefault();
                    mouseX = event.touches[0].pageX - windowHalfX;
                    mouseY = event.touches[0].pageY - windowHalfY;
                }
            }

        </script>
    </body>
</html>